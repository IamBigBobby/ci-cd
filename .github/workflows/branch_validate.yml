name: Validate Branch Name on Push and Merge to Main

on:
  push:
    branches:
      - 'feature/*'
  pull_request:
    branches:
      - 'main'

jobs:
  validate-branch:
    runs-on: ubuntu-latest
    steps:
      - name: Validate branch name
        run: |
          if [[ "$GITHUB_EVENT_NAME" == "push" ]]; then
            BRANCH_NAME="${GITHUB_REF#refs/heads/}"
          else
            BRANCH_NAME="${GITHUB_HEAD_REF}"
          fi

          echo "Branch name: $BRANCH_NAME"

          if [[ ! "$BRANCH_NAME" =~ ^feature\/[a-z0-9-]+$ ]]; then
            echo "Error: Wrong branch name. Expected format: feature/xxx."
            exit 1
          fi
        shell: bash

